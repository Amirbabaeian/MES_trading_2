# Polygon.io Data Provider Configuration Template
# 
# This file provides a configuration template for the Polygon.io adapter.
# Copy this to your local configuration and fill in your API key.
# 
# WARNING: Keep your API key secure. Never commit actual credentials to version control.
# Use environment variables or secret management for production deployments.

# API connection settings
api:
  # Polygon.io API base URL
  base_url: "https://api.polygon.io"
  
  # API version
  version: "v1"
  
  # API key (use environment variable: POLYGON_API_KEY)
  api_key: "${POLYGON_API_KEY}"
  
  # Request timeout in seconds
  timeout: 30
  
  # Connection pooling (keep-alive)
  use_connection_pool: true

# Rate limiting
# Polygon has tier-based limits
rate_limiting:
  # Rate limit by subscription tier:
  # - Free:          5 requests/minute
  # - Starter:       30 requests/minute
  # - Professional:  600 requests/minute
  # - Enterprise:    custom limit
  
  # Default: Free tier
  max_requests: 5
  
  # Rate limit period in seconds
  period_seconds: 60.0
  
  # Automatic backoff when rate limited
  enable_backoff: true
  
  # Maximum backoff delay in seconds
  max_backoff_seconds: 60.0

# Retry configuration
retry:
  # Maximum retry attempts for failed requests
  max_retries: 3
  
  # Initial backoff delay in seconds
  base_delay: 1.0
  
  # Maximum backoff delay in seconds
  max_delay: 60.0
  
  # Exponential backoff multiplier
  exponential_base: 2.0
  
  # Add random jitter to prevent thundering herd
  jitter: true
  
  # Retry on these HTTP status codes
  retryable_status_codes:
    - 429  # Too Many Requests
    - 500  # Internal Server Error
    - 502  # Bad Gateway
    - 503  # Service Unavailable
    - 504  # Gateway Timeout

# Data fetching options
data:
  # Default timeframe for aggregation
  default_timeframe: "1D"
  
  # Supported aggregation timeframes
  supported_timeframes:
    - "1M"    # 1 minute
    - "5M"    # 5 minutes
    - "15M"   # 15 minutes
    - "30M"   # 30 minutes
    - "1H"    # 1 hour
    - "1D"    # 1 day (default)
    - "1W"    # 1 week
    - "1MO"   # 1 month
    - "1Q"    # 1 quarter
    - "1Y"    # 1 year
  
  # Maximum bars per request (Polygon limit varies by endpoint)
  max_bars_per_request: 50000
  
  # Enable automatic pagination for large date ranges
  auto_pagination: true
  
  # Pagination batch size (days per request)
  pagination_batch_days: 365
  
  # Request timeout in seconds
  request_timeout: 30

# Symbol configuration
symbols:
  # Asset class support
  supported_classes:
    - "STOCKS"
    - "OPTIONS"
    - "FOREX"
    - "CRYPTO"
  
  # Default symbols to monitor
  defaults:
    - "AAPL"
    - "MSFT"
    - "TSLA"
    - "SPY"
    - "QQQ"
  
  # Symbol market filters
  markets:
    - "stocks"
    # - "forex"
    # - "options"
    # - "crypto"

# Data adjustments
adjustments:
  # Apply dividend adjustments to prices
  adjust_dividends: true
  
  # Apply stock split adjustments to prices
  adjust_splits: true
  
  # Return adjusted close prices
  use_adjusted: true

# Caching
caching:
  # Enable response caching
  enable_cache: true
  
  # Cache TTL in seconds (24 hours)
  cache_ttl: 86400
  
  # Cache directory for persistent caching
  cache_dir: ".cache/polygon"

# Logging
logging:
  # Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
  level: "INFO"
  
  # Log API requests and responses
  log_api_calls: true
  
  # Log rate limit events
  log_rate_limit: true
  
  # Log response sizes
  log_response_size: false

# Feature flags
features:
  # Support real-time streaming data
  streaming: false
  
  # Support tick-level data
  tick_data: false
  
  # Support quotes/snapshots
  quotes: false
